<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>MAAS Client Library & CLI</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Home";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> MAAS Client Library & CLI
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="index.html">Home</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Client</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="client/index.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="client/nodes.html">Nodes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="client/networking.html">Networking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="client/interfaces.html">Interfaces</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="client/events.html">Events</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="client/other.html">Others</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="development/releasing.html">Release checklist</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="development/adding-an-object.html">Adding an object</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAAS Client Library & CLI</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Home</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/maas/python-libmaas/edit/master/docs/index.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1>Welcome to MAAS's new command-line tool &amp; Python client library</h1>

<p><em>python-libmaas</em> provides:</p>
<ul>
<li>
<p>A command-line tool for working with MAAS servers.</p>
</li>
<li>
<p>A rich and stable Python client library for interacting with MAAS 2.0+
  servers. This can be used in a synchronous/blocking mode, or an
  asynchronous/non-blocking mode based on <a href="https://docs.python.org/3/library/asyncio.html">asyncio</a>.</p>
</li>
<li>
<p>A lower-level Python client library, auto-generated to match the MAAS
  server it&rsquo;s interacting with.</p>
</li>
</ul>
<p>For MAAS <em>server</em> documentation, visit
<a href="https://docs.ubuntu.com/maas/">docs.ubuntu.com</a>.</p>
<hr />
<p>This is <strong>ALPHA</strong> software. We are converging on a finished product, but
until we release a beta all APIs could change.</p>
<hr />
<h2 id="installation">Installation</h2>
<p>Either work from a branch:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>git clone https://github.com/maas/python-libmaas.git
<span class="gp">$ </span><span class="nb">cd</span> python-libmaas
<span class="gp">$ </span>make
</code></pre></div>

<p>Or install with <a href="https://pip.pypa.io/">pip</a> into a
<a href="https://virtualenv.readthedocs.org/">virtualenv</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>virtualenv --python<span class="o">=</span>python3 amc <span class="o">&amp;&amp;</span> <span class="nb">source</span> amc/bin/activate
<span class="gp">$ </span>pip install git+https://github.com/maas/python-libmaas.git
</code></pre></div>

<p>Or install from <a href="https://pypi.python.org/">PyPI</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>virtualenv --python<span class="o">=</span>python3 amc <span class="o">&amp;&amp;</span> <span class="nb">source</span> amc/bin/activate
<span class="gp">$ </span>pip install python-libmaas
</code></pre></div>

<p><strong>Note</strong> that PyPI may lag the others.</p>
<p>This documentation assumes you&rsquo;re working from a branch or in a
virtualenv. In practice this means it will use partially qualified paths
like <code>bin/maas</code> instead of bare <code>maas</code> invocations. If you&rsquo;ve
installed from PyPI the <code>maas</code> command will probably be installed on
your shell&rsquo;s <code>PATH</code> so you can invoke it as <code>maas</code>.</p>
<h2 id="command-line">Command-line</h2>
<p>Best place to start with the CLI is the help menu.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas <span class="nb">help</span>
<span class="gp">$ </span>bin/maas <span class="nb">help</span> commands
</code></pre></div>

<p>Once your have familiarized yourself with the available commands you will
want to login to your MAAS. You can either pass arguments to login or it
will ask your for the needed information to login.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas login
</code></pre></div>

<p>The CLI supports multiple profiles with <code>login</code>. Use <code>profiles</code> and
<code>switch</code> to view and change between profiles.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas profiles
<span class="go">┌─────────┬─────────────────────────────────────┬────────┐</span>
<span class="go">│ Profile │ URL                                 │ Active │</span>
<span class="go">├─────────┼─────────────────────────────────────┼────────┤</span>
<span class="go">│ admin   │ http://localhost:5240/MAAS/api/2.0/ │ ✓      │</span>
<span class="go">│ other   │ http://localhost:5240/MAAS/api/2.0/ │        │</span>
<span class="go">└─────────┴─────────────────────────────────────┴────────┘</span>
<span class="gp">$ </span>bin/maas switch other
<span class="gp">$ </span>bin/maas profiles
<span class="go">┌─────────┬─────────────────────────────────────┬────────┐</span>
<span class="go">│ Profile │ URL                                 │ Active │</span>
<span class="go">├─────────┼─────────────────────────────────────┼────────┤</span>
<span class="go">│ admin   │ http://localhost:5240/MAAS/api/2.0/ │        │</span>
<span class="go">│ other   │ http://localhost:5240/MAAS/api/2.0/ │ ✓      │</span>
<span class="go">└─────────┴─────────────────────────────────────┴────────┘</span>
</code></pre></div>

<p>The <code>nodes</code>, <code>machines</code>, <code>devices</code>, and <code>controllers</code> provide access
to either all nodes with <code>nodes</code> or specific node types with <code>machines</code>,
<code>devices</code>, and <code>controllers</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas nodes
<span class="go">┌────────────────────┬───────────────┐</span>
<span class="go">│ Hostname           │ Type          │</span>
<span class="go">├────────────────────┼───────────────┤</span>
<span class="go">│ another            │ Device        │</span>
<span class="go">│ blake-ubnt-desktop │ Regiond+rackd │</span>
<span class="go">│ testing            │ Device        │</span>
<span class="go">│ win2016            │ Machine       │</span>
<span class="go">└────────────────────┴───────────────┘</span>
<span class="gp">$ </span>bin/maas machines
<span class="go">┌──────────┬───────┬────────┬───────┬───────┬────────┐</span>
<span class="go">│ Hostname │ Power │ Status │ Arch  │ #CPUs │ RAM    │</span>
<span class="go">├──────────┼───────┼────────┼───────┼───────┼────────┤</span>
<span class="go">│ win2016  │ Off   │ Broken │ amd64 │ 4     │ 8.0 GB │</span>
<span class="go">└──────────┴───────┴────────┴───────┴───────┴────────┘</span>
<span class="gp">$ </span>bin/maas devices
<span class="go">┌──────────┬───────────────┐</span>
<span class="go">│ Hostname │ IP addresses  │</span>
<span class="go">├──────────┼───────────────┤</span>
<span class="go">│ another  │ 192.168.1.223 │</span>
<span class="go">│ testing  │ 192.168.1.150 │</span>
<span class="go">│          │ 192.168.1.143 │</span>
<span class="go">└──────────┴───────────────┘</span>
<span class="gp">$ </span>bin/maas controllers
<span class="go">┌────────────────────┬───────────────┬───────┬───────┬─────────┐</span>
<span class="go">│ Hostname           │ Type          │ Arch  │ #CPUs │ RAM     │</span>
<span class="go">├────────────────────┼───────────────┼───────┼───────┼─────────┤</span>
<span class="go">│ blake-ubnt-desktop │ Regiond+rackd │ amd64 │ 8     │ 24.0 GB │</span>
<span class="go">└────────────────────┴───────────────┴───────┴───────┴─────────┘</span>
</code></pre></div>

<p>Tab-completion in <code>bash</code> and <code>tcsh</code> is supported too. For example,
in <code>bash</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span><span class="nb">source</span> &lt;<span class="o">(</span>bin/register-python-argcomplete --shell<span class="o">=</span>bash bin/maas<span class="o">)</span>
<span class="gp">$ </span>bin/maas &lt;tab&gt;
<span class="go">allocate  files  login  nodes  shell  ...</span>
</code></pre></div>

<h2 id="client-library">Client library</h2>
<p>For a developer the simplest entry points into <code>python-libmaas</code> are
the <code>connect</code> and <code>login</code> functions in <code>maas.client</code>. The former
connects to a MAAS server using a previously obtained API key, and the
latter logs-in to MAAS with your username and password. These returns a
<code>Client</code> object that has convenient attributes for working with MAAS.</p>
<p>For example, this prints out all interfaces on all machines:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">maas.client</span> <span class="kn">import</span> <span class="n">login</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">login</span><span class="p">(</span>
    <span class="s2">&quot;http://localhost:5240/MAAS/&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;my_user&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;my_pass&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tmpl</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0.hostname}</span><span class="s2"> </span><span class="si">{1.name}</span><span class="s2"> </span><span class="si">{1.mac_address}</span><span class="s2">&quot;</span>
<span class="k">for</span> <span class="n">machine</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">machines</span><span class="o">.</span><span class="n">list</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">machine</span><span class="o">.</span><span class="n">interfaces</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tmpl</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">machine</span><span class="p">,</span> <span class="n">interface</span><span class="p">))</span>
</code></pre></div>

<p>Learn more about the <a href="client/index.html">client</a>.</p>
<h2 id="shell">Shell</h2>
<p>There&rsquo;s an interactive shell. If a profile name is given or a default
profile has been set — see <code>maas profiles --help</code> — this places a
<code>Client</code> instance in the default namespace (as <code>client</code>) that you
can use interactively or in a script.</p>
<p>For the best experience install <a href="https://ipython.org/">IPython</a> first.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas shell
<span class="go">Welcome to the MAAS shell.</span>
<span class="go">...</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">origin</span><span class="o">.</span><span class="n">Version</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&lt;Version 2.2.0 beta2+bzr5717 [bridging-automatic-ubuntu ...]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="go">[..., &#39;account&#39;, &#39;boot_resources&#39;, ...]</span>
</code></pre></div>

<p>Scripts can also be run. For example, given the following <code>script.py</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Machines:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">machines</span><span class="o">.</span><span class="n">list</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Devices:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">list</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Racks:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">rack_controllers</span><span class="o">.</span><span class="n">list</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regions:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">region_controllers</span><span class="o">.</span><span class="n">list</span><span class="p">()))</span>
</code></pre></div>

<p>the following will run it against the default profile:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/maas shell script.py
<span class="go">Machines: 1</span>
<span class="go">Devices: 0</span>
<span class="go">Racks: 2</span>
<span class="go">Regions: 1</span>
</code></pre></div>

<h2 id="development">Development</h2>
<p>It&rsquo;s easy to start hacking on <em>python-libmaas</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>git clone git@github.com:maas/python-libmaas.git
<span class="gp">$ </span><span class="nb">cd</span> python-libmaas
<span class="gp">$ </span>make develop
<span class="gp">$ </span>make <span class="nb">test</span>
</code></pre></div>

<p>Installing <a href="https://ipython.org/">IPython</a> is generally a good idea too:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">$ </span>bin/pip install -UI IPython
</code></pre></div>

<p>Pull requests are welcome but authors need to sign the <a href="https://www.ubuntu.com/legal/contributors">Canonical
contributor license agreement</a> before those PRs can be merged.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="client/index.html" class="btn btn-neutral float-right" title="Introduction">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/maas/python-libmaas" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
      <span><a href="client/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.3.1
Build Date UTC : 2022-08-17 10:48:42.507913+00:00
-->
